# SMS转发功能测试指南

## 🚀 快速开始

### 1. 确保应用就绪
1. **权限检查**：打开应用，进入"设置"页面
2. **查看SMS功能状态**：确认"SMS权限已授予"和"SMS转发功能就绪"
3. **邮箱配置**：确保邮箱已正确配置并测试连接成功

### 2. 测试SMS接收功能

## 🖥️ 方法1：Android Studio模拟器测试（推荐）

### 使用Extended Controls
1. **启动模拟器**：在Android Studio中启动AVD
2. **打开Extended Controls**：
   - 点击模拟器侧边栏的"..."按钮
   - 或使用快捷键：`Ctrl+Shift+P` (Windows/Linux) 或 `Cmd+Shift+P` (Mac)
3. **进入SMS功能**：
   - 在Extended Controls中选择"Phone"
   - 切换到"SMS"标签页
4. **发送测试短信**：
   - **发送方号码**：`+8613812345678`（或任意手机号）
   - **短信内容**：`【工商银行】您的账户1234收到转账1000.00元，余额12345.67元`
   - 点击"Send Message"

### 使用ADB命令（批量测试）
```bash
# 发送银行通知短信
adb emu sms send +8613812345678 "【工商银行】您的账户1234收到转账1000.00元，余额12345.67元"

# 发送验证码短信
adb emu sms send +8613987654321 "【淘宝网】验证码123456，用于登录，5分钟内有效"

# 发送购物通知
adb emu sms send +8613555666777 "【京东】您的订单已发货，快递单号：SF1234567890"

# 发送支付通知
adb emu sms send +8613111222333 "【微信支付】您已成功付款100.00元给商户某某超市"
```

## 📱 方法2：真机测试

### 安装到真机
1. **启用开发者选项**：
   - 进入"设置" > "关于手机"
   - 连续点击"版本号"7次
2. **启用USB调试**：
   - 进入"设置" > "开发者选项"
   - 开启"USB调试"
3. **安装应用**：
   ```bash
   ./gradlew installDebug
   ```
4. **请朋友发送测试短信**：让朋友发送包含关键词的短信进行测试

## 🔧 方法3：应用内测试工具（Debug版本）

### 使用内置测试按钮
1. **进入设置页面**：在应用底部导航选择"设置"
2. **找到调试测试区域**：滚动到页面底部（仅Debug版本显示）
3. **使用测试按钮**：
   - **银行通知**：测试银行相关短信
   - **验证码**：测试验证码短信
   - **发送所有测试短信**：批量测试各种类型短信

## 📊 验证转发是否成功

### 1. 应用内检查
- **主页面**：查看"今日"统计数字是否增加
- **日志页面**：查看是否有新的转发记录
- **统计页面**：查看成功率是否正常

### 2. 邮箱检查
- 检查配置的接收邮箱是否收到转发邮件
- 邮件主题应包含发送方号码和关键信息
- 邮件内容应包含完整短信内容和时间戳

### 3. Android日志检查
```bash
# 查看SMS接收日志
adb logcat | grep SmsReceiver

# 查看WorkManager处理日志
adb logcat | grep SmsForwardWorker

# 查看所有应用日志
adb logcat | grep "com.example.test"
```

## 🐛 常见问题排查

### 1. SMS没有被接收
**可能原因：**
- SMS权限未授予
- 广播接收器未正确注册
- 模拟器SMS功能异常

**解决方法：**
1. 检查应用权限：设置 > 应用管理 > SMS转发器 > 权限
2. 重新安装应用
3. 重启模拟器
4. 尝试不同的测试方法

### 2. SMS接收但未转发
**可能原因：**
- 邮箱配置错误
- 网络连接问题
- 转发规则不匹配

**解决方法：**
1. 测试邮箱连接："邮箱配置" > "测试连接"
2. 检查网络连接
3. 查看日志确认错误信息
4. 检查转发规则设置

### 3. 邮件发送失败
**可能原因：**
- SMTP服务器配置错误
- 邮箱密码或应用专用密码错误
- 防火墙或网络限制

**解决方法：**
1. 验证SMTP设置
2. 检查邮箱服务商的安全设置
3. 使用应用专用密码（Gmail、Outlook等）
4. 尝试不同的SMTP端口和加密设置

## 📝 测试记录模板

### 测试环境
- [ ] 模拟器版本：_______
- [ ] Android版本：_______
- [ ] 应用版本：_______
- [ ] SMS权限状态：_______
- [ ] 邮箱配置状态：_______

### 测试用例
- [ ] 银行通知短信转发
- [ ] 验证码短信转发
- [ ] 购物通知短信转发
- [ ] 支付通知短信转发
- [ ] 垃圾短信过滤
- [ ] 邮件发送成功
- [ ] 统计数据更新

### 测试结果
- [ ] SMS正常接收
- [ ] 邮件成功发送
- [ ] 统计正确更新
- [ ] 日志记录完整

## 💡 优化建议

### 性能测试
1. **批量短信测试**：使用"发送所有测试短信"功能
2. **并发处理**：短时间内发送多条短信
3. **长时间运行**：保持应用运行并定期发送测试短信

### 兼容性测试
1. **不同Android版本**：测试API 23-34
2. **不同设备厂商**：小米、华为、三星等
3. **不同网络环境**：WiFi、4G、5G

### 边界测试
1. **超长短信**：测试长短信的处理
2. **特殊字符**：包含emoji、特殊符号的短信
3. **网络异常**：断网情况下的处理
4. **存储满载**：设备存储空间不足时的处理

---

**注意**：在真机测试时，请确保不会影响正常的短信接收和处理。建议使用专门的测试设备或SIM卡。 